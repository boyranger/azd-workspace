name: zeroclaw
metadata:
  subscription: ${AZURE_SUBSCRIPTION_ID}
  location: ${AZURE_LOCATION}
  resource_group: ${AZURE_RESOURCE_GROUP}

infra:
  bicep: ./infra/main.bicep
  parameters:
    - name: zeroclawContainerAppExists
      value: ${ZEROCLAW_CONTAINER_APP_EXISTS=false}
    - name: containerMinReplicaCount
      value: 1
    - name: containerMaxReplicaCount
      value: 1
    - name: useSqlite
      value: true
    - name: zeroclaw_master_key
      value: ${ZEROCLAW_MASTER_KEY}
    - name: zeroclaw_salt_key
      value: ${ZEROCLAW_SALT_KEY}

services:
  zeroclaw:
    project: ./src/zeroclaw
    host: containerapp
    language: rust
    docker:
      context: ./
      path: DOCKERFILE
    resources:
      cpu: 0.5
      memory: 1Gi
